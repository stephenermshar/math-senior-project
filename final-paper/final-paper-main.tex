\input{final-paper-preamble.tex}

\title[Persistent Homology]{Persistent Homology: Computations and Applications}
\author{Stephen Ermshar}
\address{Department of Mathematics, Walla Walla University, College Place, WA 99324}
\date{\DTMDisplaydate{2020}{6}{5}{}} % Final Draft due
\thanks{Advisor: Dr. John Foster}

% for keeping track of printed drafts, adds date and time to every page
\thanks{\tiny{\DTMtoday, \DTMcurrenttime}}
\rfoot{\hfill\newline\tiny{\DTMtoday, \DTMcurrenttime}}


\begin{document}

\begin{abstract}
    % <300 word abstract.
    Persistent homology is a method for understanding a numerical multi dimensional data set by observing certain features of shapes generated by the data.
    These features of interest are holes, and can provide clues for how the data is connected.
    homology is the study of these holes, and persistent homology is a natural application of this topic to data sets.
    This paper will provide an introduction to simplicial homology and how it can be applied to a data set.
\end{abstract}
\maketitle

\section{Introduction}

Persistent homology is a tool for understanding the shape of a data set.
If a data set is a collection of points in two dimensional space, then it can be graphed in a plane.
We can easily look at the graph and see whether the data clumps together in certain places, or if it forms more interesting shapes, like loops.
We can graph data from one and three dimensions as well, but with dimensions four and higher we are no longer able to visualize the data in a traditional scatter plot.

\begin{figure}[h]
    \centering
    \scalebox{0.75}{\input{tikz/persistence-demo.tex}}
    \caption{}
    \label{fig:persistence-demo-r25}
\end{figure}

To get an idea of the shape formed by a data set we connect nearby points.
A threshold radius can be used to determine whether points are close enough to be considered related.
With the resulting graph-like structure we can apply tools from homology to find holes like the two shown in Figure \ref{fig:persistence-demo-r25}.
Homology will help us find higher dimensional analogues of these holes as well, such as voids, which are the space inside an enclosed surface.

The graph-like structure, which is called a simplicial complex, will change depending on the value of the radius.
If the radius is small enough then no points will be connected, and if it is large enough then all the points will be connected.
Between these two extremes more interesting simplicial complexes result.
As the radius increases, points will begin to connect and holes will form.
Eventually, as more points connect, those holes will get filled in.
The holes that persist over a wide range of radius values are considered to be the more significant features of the shape.

In section \ref{sec:homology} we'll formalize the simplicial complex and its building blocks.
Then, given an existing simplicial complex we'll solidify the concept with an example computation for finding a hole.
As we move on to persistent homology in section \ref{sec:persistent-homology}, we'll introduce the \cech complex, which is used to build a simplicial complex given a data set and a radius.
Having calculated the homology for the \cech complex along a range of scales we'll look at two methods for visualizing the results, and \red{might} look at the stability theorem, which will ensure that the results are reliable.
Finally, in section \ref{sec:applications} we \red{might} explore applications for persistent homology.

\section{Homology}\label{sec:homology}

\subsection{Simplicial Homology}\label{sec:simplicial-homology}

The basic building block of a simplicial complex is an \(n\)-simplex. % are simplices
An \(n\)-simplex generalizes the triangle to \(n\) dimensions by associating \(n+1\) vertices with each other in an ordered tuple.
A point is a 0-simplex, an edge a 1-simplex, a triangle a 2-simplex, a tetrahedron a 3-simplex, and so on \figref{fig:basic-simplices}.

\begin{figure}
    \input{./tikz/basic-simplices.tex}
    \caption{}
    \label{fig:basic-simplices}
\end{figure}

A simplicial complex will be a collection of simplices.
For a simplex to be considered part of a simplicial complex it will need to have been built up from lower dimensional simplices.
A triangle includes its three edges and three vertices, so if a triangle is included in a simplicial complex, then we will require that all of its edges and vertices also be included in the complex.

\begin{definition}\label{def:simplicial-complex}
    A \textbf{simplicial complex} is a finite collection of finite sets such that every subset of every element in the collection is also an element in the collection. \cite{wagner}
\end{definition}

This will be a useful property because when we study the homology of the complex we will be comparing the boundaries of its \(n\)-simplices, which are \((n-1)\)-simplices, to other \((n-1)\)-simplices in the complex.

Homology will be calculated by finding all the loops of \((n-1)\)-simplices, and ignoring any loops of \((n-1)\)-simplices around \(n\)-simplices, leaving only loops of \((n-1)\)-simplices that surround empty space that could be filled with \(n\)-simplices.
These remaining loops are what we intuitively call holes.

A path of \(n\)-simplices can just be thought of as a list of \(n\)-simplices; this makes intuitive sense for 1-simplices, where a list of edges describes a 1-dimensional path through a complex, but still works for larger values of \(n\).
For instance, a closed path of 2-simplices around a tetrahedron consists of its four faces.

\subsection{Computations}

In practice we can think of paths of \(n\)-simplices as linear combinations of \(n\)-simplices.
Figure \ref{fig:example-cech} shows a complex \(C = \{ (1,2,3), (1,2), (1,3), (2,3), (2,4), (3,4), (1), (2), (3), (4) \}\) where \(\ell_1\) is the closed clockwise path of 1-simplices around the outside of the complex and \(\ell_2\) is the closed counterclockwise path of 1-simplices around the 2-simplex \((1,2,3)\).
When we write down a simplex we always write its elements in increasing order by label.
Note that the negative signs in \(\ell_1\) and \(\ell_2\) correspond to traveling backwards along an edge.
This convention allows us to give each simplex an orientation, so that when we add a simplex to a copy of itself with an opposite orientation they will cancel out.
If we were to add \(\ell_1\) and \(\ell_2\), the simplices \((1, 3)\) and \((1, 2)\) would cancel out, leaving the element \((3, 4) - (2, 4) + (2, 3)\), which corresponds to the loop around the hole.

A closed path of \((n-1)\)-simplices around an \(n\)-simplex will represent the boundary of the \(n\)-simplex.
We can also add \(n\)-simplices together and take the boundary of the resulting element.
To more formally describe boundaries of \(n\)-simplices we define the boundary homomorphism, which maps elements from the group of \(n\)-simplices to elements in the group of \((n-1)\)-simplices.

\begin{definition}\label{def:boundary-homomorphism}
    The \(n\textsuperscript{th}\) \textbf{boundary homomorphism} \(\boundary_n : C_n \to C_{n-1}\) is
    \[
        \boundary_n (v_1,\dots , v_{n+1}) = \sum_{i=1}^{n+1} (-1)^{i+1}
        (v_1,\dots, v_{i-1}, v_{i+1}, \dots, v_{n+1})
        .
    \]
    \cite{hatcher}
\end{definition}

\begin{example}
    If the example complex in Figure \ref{fig:example-cech} were to include the triangle \((2,3,4)\), then we could combine the two triangles and would expect their boundary to be the loop around the outside of the complex, \(\ell_1\).
    The triangle \((2,3,4)\) has clockwise orientation, while \((1,2,3)\) has counterclockwise orientation.
    If we were to give them both the same orientation and then add them, then the simplex \((2,3)\) in their boundaries would cancel, resulting in \(\ell_1\), as expected.
\end{example}

The boundary homomorphism will help us find all boundaries of \(n\)-simplices in a complex.
With the help of Theorem \ref{thm:zero-boundary} we'll also be able to find all closed paths of \(n\)-simplices in a complex.

\begin{theorem}\label{thm:zero-boundary}
    The composition of two boundary homomorphisms is zero.
    For any element \(c\) in the group of \((n+1)\)-simplices
    \begin{align*}
        \boundary_{n} \big( \boundary_{n+1} (c) \big) = 0
        .
    \end{align*}
    \cite{fraleigha}
\end{theorem}

Since the boundary of a boundary is always zero, the boundary of any element from the group of \((n+1)\)-simplices is in the kernel of the \(n\textsuperscript{th}\) boundary homomorphism, that is, \(\Ima(\boundary_{n+1}) \subseteq \Ker(\boundary_n)\).
The kernel of a boundary homomorphism will represent all closed paths in a complex \cite{fraleigha}.

Since we're not concerned with the order in which simplices are added, the groups of simplices are abelian, so \(\Ima(\boundary_{n+1})\) is a normal subgroup of \(\Ker(\boundary_{n})  \).

\begin{definition}\label{def:nth-homology-group}
    The \(n\textsuperscript{th}\) \textbf{homology group} is \[H_n = \bigslant{\Ker(\boundary_n)}{\Ima(\boundary_{n+1})}.\]
    \cite{fraleigha}
\end{definition}

This is the group of closed paths, or cycles, modded out by cycles around simplices and is used to describe \(n\)-dimensional holes in the complex.
The result is just the cycles not surrounding simplices.
We will demonstrate this computation to find the first homology group of the complex shown in Figure \ref{fig:example-cech}.

\begin{example}

    \begin{figure}
        \centering
        \begin{minipage}{.5\textwidth}
            \centering
            \input{./tikz/example-cech.tex}
        \end{minipage}%
        \begin{minipage}{.5\textwidth}
            \begin{align*}
                C_1 &= \langle (1,2),(1,3),(2,3),(2,4),(3,4) \rangle \\
                C_2 &= \langle (1,2,3) \rangle \\
                \ell_1 &= (1,3) + (3,4) - (2,4) - (1,2)\\
                \ell_2 &= (2,3) - (1,3) + (1,2)
            \end{align*}
        \end{minipage}
        \caption{}
        \label{fig:example-cech}
    \end{figure}

    In Figure \ref{fig:example-cech}, \(C_1\) and \(C_2\) are the groups of 1-simplices and 2-simplices respectively for the shown complex.
    To find the first homology group we need to calculate \(\Ker(\boundary_1)\) and \(\Ima(\boundary_2)\).
    The kernel of \(\boundary_1\) is all of the elements \(s \in C_1\) such that \(\boundary_1(s) = 0\).
    We can represent an arbitrary element \(s\) of \(C_1\) as a linear combination of 1-simplices with integer coefficients.
    \begin{align}
        \boundary_1(s) &= \boundary_1\big( a(1,2) + b(1,3) + c(2,3) + d(2,4) + e(3,4) \big) \\
        &= a(2) - a(1) + b(3) - b(1) + c(3) - c(2) + d(4) - d(2) + e(4) - e(3)\\
        &= (-a - b)(1) + (a - c - d)(2) + (b + c - e)(3) + (d + e)(4)\\
        &=  \begin{bmatrix}
                (1)\\(2)\\(3)\\(4)\\
            \end{bmatrix}^T
            \left[
            \begin{array}{rrrrr}
                -1 & -1 &  0 &  0 &  0 \\
                 1 &  0 & -1 & -1 &  0 \\
                 0 &  1 &  1 &  0 & -1 \\
                 0 &  0 &  0 &  1 &  1 \\
            \end{array}
            \right]
            \begin{bmatrix}
                a\\b\\c\\d\\e\\
            \end{bmatrix}
        = 0 \label{eq:kernel-matrix}
    \end{align}

    The null space of the matrix in equation \eqref{eq:kernel-matrix} is the space of all linear combinations of 1-simplices such that their boundaries are \(0\). Thus,
    \begin{align}
        \Ker(\boundary_1) &= \{ (c - e)(1,2) + (-c + e)(1,3) + (c)(2,3) + (-e)(2,4) + (e)(3,4)\ |\ c,e \in \Z \}\\
            &= \left\{ (c)\big( (1,2) + (2,3) - (1,3)\big) + (e)\big((1,3) + (3,4) - (2,4) - (1,2)\big)\ |\ c,e \in \Z \right\}\\
            &= \langle \ell_1, \ell_2 \rangle
        . \text{ \red{(match the order of 1-simplices listed with \(\ell_1\) and \(\ell_2\) from the figure.)}}
    \end{align}

    The image of \(\boundary_2\) can be found similarly, by parameterizing an arbitrary element of \(C_2\) and applying the boundary homomorphism.
    \begin{align}
        \Ima (\partial_2)   &= \partial_2 (C_2) \\
            &= \left\{ \partial_2 \big( a(1,2,3) \big)\ |\ a \in \Z \right\} \\
            &= \left\{ a\big((2,3) - (1,3) + (1,2) \big)\ |\ a \in \Z \right\}\\
            &= \langle \ell_2 \rangle
    \end{align}

    We can now calculate the first homology group
    \begin{align}
        H_1 &= \bigslant{\Ker(\boundary_1)}{\Ima(\boundary_{2})}
        = \bigslant{\langle \ell_1, \ell_2 \rangle}{\langle \ell_2 \rangle}
        = \bigslant{\{ a\,\ell_1 + b\,\ell_2\ |\ a,b \in \Z \}}{\{ c\,\ell_2\ |\ c \in \Z \}} \\
        &= \big\{ (a\,\ell_1 + b\,\ell_2) + \{ c\,\ell_2\ |\ c \in \Z \}\ |\ a,b \in \Z \big\} \\
        &= \big\{ (a\,\ell_1) + \{ d\,\ell_2\ |\ d \in \Z \}\ |\ a \in \Z \big\} \label{eq:first-homology-group}\\
        &\simeq \Z
    \end{align}

    To interpret the homology group notice in equation \eqref{eq:first-homology-group} that all possible combinations of 1-simplices around \((1,2,3)\) are together in one set for each individual loop around the entire complex.
    If we think of each of these sets as an equivalence class, then we can interpret the homology group as the group of cycles that surround the hole, regardless of how many times they surround the filled in triangle.
    The set of loops around a single hole is sometimes called homology class \red{(cite? or remove this sentence?)}.
    This group is isomorphic to \(\Z\), which corresponds to the idea that the cycles surrounding the hole can wrap around it an integer number of times.
    Each set in the first homology group represents one of those cycles.
    If there were two holes, then each hole could have cycles wrapped around it any integer number of times, and the first homology group would be isomorphic to \(\Z \oplus \Z\).

    One interpretation of the first homology group compares it to rubber bands.
    If a rubber band is allowed to move anywhere within the complex, then it can wrap around holes, or it can be placed freely within higher dimensional simplices.
    If it surrounds a hole at any point and is allowed to ``snap'' into place it will tighten around the hole some integer number of times \red{(cite?)}.
\end{example}

\section{Persistent Homology}\label{sec:persistent-homology}

\subsection{The \cech Complex}\label{sec:cech-complex}

The \cech complex gives us a meaningful and intuitive way to build a simplicial complex given a set of points, a way to measure distance, and a radius.

\begin{definition}\label{def:cech-complex}
    Given a set of points \(P\), and a distance \(r\), let \(B_x(r)\) be the ball with radius \(r\) around the point \(x\).
    The \textbf{\cech complex} is given by
		\begin{align*}
            \Cech(r) = \left\{ S \subseteq P \mid \textstyle{\bigcap_{x\in S}} \,B_x(r) \neq \emptyset \right\}
            .
		\end{align*}
		\cite{wagner}
\end{definition}

We can observe that the \v{C}ech complex fits the definition of a simplicial complex.
Since, if the balls around a set of points intersect, then the balls around any subset of those points must also intersect.

\begin{example}\label{exa:example-cech-persistence}
    Figure \ref{fig:example-cech-r} shows the same points used in Figure \ref{fig:example-cech} with different radius values.

    \begin{figure}
        \centering
        \begin{minipage}{.3\textwidth}
            \centering
            \input{tikz/example-cech-1.tex}
        \end{minipage}%
        \begin{minipage}{.3\textwidth}
            \centering
            \input{tikz/example-cech-2.tex}
        \end{minipage}%
        \begin{minipage}{.4\textwidth}
            \centering
            \input{tikz/example-cech-3.tex}
        \end{minipage}
        \caption{}
        \label{fig:example-cech-r}
    \end{figure}
\end{example}

\subsection{Persistence Diagrams}

We can visualize the homology groups as \(r\) varies in Example \ref{exa:example-cech-persistence} using a persistence barcode \subfigref{fig:example-cech-persistence}{left}.
Each bar represents a homology class in the complex, with its left endpoint at the value of \(r\) where the class appears, and its right endpoint at the value of \(r\) where the class disappears.

We can see that for values of \(r\) between 30 and 33 there is one hole where the triangle \((1,2,3)\) would be.
At \(r=33\) the balls around the points 1, 2, and 3 intersect, and the triangle \((1,2,3)\) appears, filling in the hole.
At the same value of \(r\) the edges \((3,4)\) and \((2,4)\) appear and form a hole where the triangle \((2,3,4)\) would be, as seen in Figure \ref{fig:example-cech}.
At \(r=37\), the triangle \((2,3,4)\) appears, filling in the second hole.
Finally, at \(r=56\) the balls around every point intersect, forming the tetrahedron \((1,2,3,4)\).

We can extend the analogy of the rubber band to the zeroth homology group as well.
A rubber band can be thought of as representing a one dimensional cycle in the complex, or a ``rubber'' one dimensional sphere.
In zero dimensions we have a point, which can move anywhere within a single connected component of the complex.
Thus, the zeroth homology group identifies connected components as individual homology classes.

\begin{figure}
    \centering
    \includegraphics{ipe/example-cech-persistence.pdf}
    % <29: 4 components, no holes
    %  30: 2 components, one hole (left)
    %  33: 1 component, one hole (right)
    % >37: 1 component, no holes
    %  55: (1,4) connect
    \caption{}
    \label{fig:example-cech-persistence}
\end{figure}

We can also represent the persistence barcode in a scatter plot called a persistence diagram \subfigref{fig:example-cech-persistence}{right}, where the axes \(r_b\) and \(r_d\) represent values of \(r\) where a single homology class appears and disappears, respectively.
The points corresponding to the longest most significant bars will be further from the diagonal.

\red{(Figure \ref{fig:example-cech-persistence} doesn't demonstrate a long bar as well as Figure \ref{fig:persistence-demo-r25}.)}

\subsection{Stability Theorem}\label{sec:stability-theorem}

The stability theorem helps guarantee some consistency in the persistence diagrams. Intuitively, two very similar data sets form similar shapes, so their persistence diagrams should be very similar as well.

\begin{theorem}
    \red{(Stability Theorem Statement)}
\end{theorem}

\red{\cite{cohen-steiner} first wrote about the stability theorem, but I first read about it in \cite{wagner}. Both provide intuitive descriptions, and both go in depth on it further than I think I'll have time to follow.}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\lightgray{

    The contrapositive of the stability theorem is that if two persistence diagrams are not similar, then the data must not be similar either.
    This is leveraged in a demonstration of persistent homology in signal anomaly detection.
    \cite{aktas} mentions the Wasserstein distance, which used in the signal anomaly detection demo to compare two persistence diagrams.


% % this paragraph needs to be moved to persistence sec. but the \(C\) part stays
% In Figure \ref{fig:example-cech} we start with the points labeled \(1\), \(2\), \(3\), and \(4\). We choose a value for \(r\) and construct a cech complex \(C = \{ (1,2,3), (1,2), (1,3), (2,3), (2,4), (3,4), (1), (2), (3), (4) \}\). With this complex we can fill in the remaining triangle and edges in the graph based on the simplices included in the complex. We can visually observe that this complex has one hole surrounded by \(1\)-simplices \((2,3)\), \((3,4)\), and \((2,4)\).

% \textit{\cite{cohen-steiner} discusses the stability theorem in persistent homology, which would be relevant to this paper. I've seen the theorem before in other papers and understand it to mean that small changes in the data set result in small changes to the homology. I'm having a hard time explaining how this would be useful, but it's supposed to increase confidence in the results of persistent homology. It would also give the paper a more interesting theorem than theorem \ref{thm:homology-composition}. Though theorem \ref{thm:homology-composition} is relevant to understanding definition \ref{def:nth-homology-group} even if it isn't applied.}

% \section{Persistent Homology}\label{sec:persistent-homology}

% \subsection{The Cech Complex}\label{sec:cech-complex}

% There are many ways of constructing simplicial complexes from data, but we'll focus on one of the more intuitive and original methods used, the cech complex.

\section{Applications}\label{sec:applications}

}

% \newpage

\bibliographystyle{alpha}
\bibliography{../math496-7-zotero.bib}

\end{document}
